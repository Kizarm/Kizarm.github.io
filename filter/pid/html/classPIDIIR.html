<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>PID: Dokumentace třídy PIDIIR</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PID
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generováno programem Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Hledat');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Hlavní&#160;stránka</span></a></li>
      <li class="current"><a href="annotated.html"><span>Třídy</span></a></li>
      <li><a href="files.html"><span>Soubory</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Hledat" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Seznam&#160;tříd</span></a></li>
      <li><a href="functions.html"><span>Seznam&#160;členů&#160;tříd</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Veřejné metody</a> &#124;
<a href="classPIDIIR-members.html">Seznam všech členů</a>  </div>
  <div class="headertitle">
<div class="title">Dokumentace třídy PIDIIR</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="PIDIIR_8h_source.html">PIDIIR.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Veřejné metody</h2></td></tr>
<tr class="memitem:ab196c5c55f842b1c147f2132096e7153"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab196c5c55f842b1c147f2132096e7153"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIDIIR.html#ab196c5c55f842b1c147f2132096e7153">PIDIIR</a> (<a class="el" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> kp, <a class="el" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> ki, <a class="el" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> kd)</td></tr>
<tr class="memdesc:ab196c5c55f842b1c147f2132096e7153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Konstruktor. <br /></td></tr>
<tr class="separator:ab196c5c55f842b1c147f2132096e7153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab8008ceff9014f855e3dc2ccddaf7a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4ab8008ceff9014f855e3dc2ccddaf7a"></a>
<a class="el" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIDIIR.html#a4ab8008ceff9014f855e3dc2ccddaf7a">run</a> (<a class="el" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> in)</td></tr>
<tr class="memdesc:a4ab8008ceff9014f855e3dc2ccddaf7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Průchod. <br /></td></tr>
<tr class="separator:a4ab8008ceff9014f855e3dc2ccddaf7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailní popis</h2>
<div class="textblock"><p>Klasický analogový přenos spojitého <a class="el" href="classPID.html">PID</a> regulátoru </p><p class="formulaDsp">
\[ u(t) = K_p \left\{ e(t) + \frac {1}{T_i} \int_0^t e(\tau) d\tau + T_d \frac{de(t)}{dt} \right\} \]
</p>
<p> lze pomocí <a href="http://cs.wikipedia.org/wiki/Laplaceova_transformace">Laplaceovy transformace</a> zapsat jako obraz přenosu (přechodová charakteristika): </p><p class="formulaDsp">
\[ H(p) = \frac{U(p)}{E(p)} = K_p \left\{ 1 + \frac{1}{p T_i} + p T_d \right\} \]
</p>
<p>Tady zkusíme trochu exaktnější způsob přechodu na digitální systém. I když výsledek bude stejný jako u řešení ve třídě <a class="el" href="classPID.html">PID</a>, bude z toho možná alespoň trochu vidět i jiné souvislosti a výsledný kód bude čistší. Použijeme zde metody pro návrh digitálních filtrů, v daném případě typu <a href="http://cs.wikipedia.org/wiki/Filtr_s_nekone%C4%8Dnou_impulzn%C3%AD_odezvou">IIR</a> <a href="http://en.wikipedia.org/wiki/Infinite_impulse_response">(Infinite Impulse Response)</a>. Nebudeme se zde hlouběji zabývat teorií, zůstaňme u konstatování, že filtrem IIR lze jednoduše realizovat jakýkoli obvod s vlastnostmi podobnými obvodu, realizovaného z klasických prvků analogové techniky. Míra podobnosti ve frekvenční nebo časové oblasti je pak dána zvolenou metodou přechodu od spojitého systému k diskrétnímu, tedy od Laplaceova obrazu přenosu k obrazu v <a href="http://cs.wikipedia.org/wiki/Z-transformace">transformaci Z</a>. V podstatě se dají použít následující metody:</p><ul>
<li><b>Metoda aproximace derivací diferencemi.</b> Transformační vztah je jednoduchý - \( pT = 1 - z^{-1} \) Tu zde použijeme, i když není ideální, je jednoduchá a dá stejný výsledek jako klasický <a class="el" href="classPID.html">PID</a>. Z teorie plyne, že bude-li vzorový analogový obvod stabilní, bude stabilní i výsledný návrh. Frekvenční charakteristika se bude lišit pro vyšší frekvence - srovnatelné se vzorkovací frekvencí. <b>Tohle omezení je dobré si uvědomit.</b></li>
<li><b>Metoda impulzně invariantní transformace.</b> Zachovává impulsní odezvu původního analogového obvodu. Pro svou složitost je zde téměř nepoužitelná, takže se jí nebudeme blíže zabývat.</li>
<li><b>Metoda bilineární transformace.</b> O něco složitější transformační vztah \( pT = 2 \frac{z-1}{z+1} \) je dán tím, že se derivace neaproximuje diferencí, ale derivace se integruje a integrál se počítá podle trojúhelníkového pravidla. To dá o něco lepší vlastnosti, zachovává stabilitu vzoru a měla by být i trochu odolná proti aliasingu, ale pro vyšší frekvence je třeba při návrhu postupovat podle pravidel, která přesahují obsah tohoto pojednání. Nakonec na zkoušku je to i zde zjednodušeně aplikováno ve třídě <a class="el" href="classPIDBIL.html">PIDBIL</a>, případně - <b>pro praxi důležitější - v celých číslech <a class="el" href="classPIDINT.html">PIDINT</a> (včetně limitace).</b></li>
</ul>
<p>Dobrá, dostali jsme tedy formuli </p><p class="formulaDsp">
\[ H(z) = K_p \left\{ 1 + \frac{T}{T_i} \frac{1}{1-z^{-1}} + \frac{T_d}{T} (1-z^{-1}) \right\} \]
</p>
<p> K čemu nám to bude ? Obecný IIR filtr se v časové oblasti dá popsat diferenční rovnicí takto: </p><p class="formulaDsp">
\[ y_n = \sum_{i=0}^M b_i x_{n-i} + \sum_{i=1}^N a_i y_{n-i} \]
</p>
<p> což se dá jednoduše realizovat. Transformace Z pak pro tuto diferenční rovnici dává </p><p class="formulaDsp">
\[ H(z) = \frac{Y(z)}{X(z)} = \frac{b_0 + b_1 z^{-1} + b_2 z^{-2} + ... + b_M z^{-M}} {1 - a_1 z^{-1} - a_2 z^{-2} - ... - a_N z^{-N}} \]
</p>
<p> Takže si tu naší formulku přepíšeme </p><p class="formulaDsp">
\[ H(z) = K_p \frac{(1 + \frac{T}{T_i} + \frac{T_d}{T} ) - (1 + 2 \frac{T_d}{T} ) z^{-1} + \frac{T_d}{T} z^{-2} }{(1-z^{-1})} \]
</p>
<p> A z toho jsou už jasně vidět koeficienty \( a_1 = 1, b_0 = K_p (1 + \frac{T}{T_i} + \frac{T_d}{T}) = K_p (1 + K_i + K_d) \) , \( b_1 = - K_p (1 + 2 \frac{T_d}{T}) = - K_p (1 + 2 K_d) \) , \( b_2 = K_p \frac{T_d}{T} = K_p K_d \) . A to je vše. Přepočet provedeme v konstruktoru a metoda <a class="el" href="classPIDIIR.html#a4ab8008ceff9014f855e3dc2ccddaf7a" title="Průchod. ">run()</a> je prostá </p><div class="fragment"><div class="line"><a class="code" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code" href="classPIDIIR.html#a4ab8008ceff9014f855e3dc2ccddaf7a">PIDIIR::run</a> (<a class="code" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> x0) {</div><div class="line">  <a class="code" href="FIR_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> y0 = (b0 * x0) + (b1 * x1) + (b2 * x2) + y1;</div><div class="line">  y1 = y0; x2 = x1; x1 = x0;</div><div class="line">  <span class="keywordflow">return</span> y0;</div><div class="line">}</div></div><!-- fragment --> </div><hr/>Dokumentace pro tuto třídu byla generována z následujících souborů:<ul>
<li><a class="el" href="PIDIIR_8h_source.html">PIDIIR.h</a></li>
<li>PIDIIR.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generováno programem &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
